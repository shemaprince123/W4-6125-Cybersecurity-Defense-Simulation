# Basic rules for intrusion detection

# Port scanning detection
alert tcp any any -> \ any (msg:"SCAN - Potential Port Scan"; detection_filter:track by_src, count 30, seconds 60; sid:1000001; rev:1;)

# SSH brute force attempt
alert tcp any any -> \ 22 (msg:"ATTACK - SSH Brute Force Attempt"; flow:to_server; threshold:type threshold, track by_src, count 5, seconds 60; sid:1000002; rev:1;)

# Web application attacks
alert tcp any any -> \ 80 (msg:"WEB - SQL Injection Attempt"; content:"UNION SELECT"; nocase; sid:1000003; rev:1;)
alert tcp any any -> \ 80 (msg:"WEB - XSS Attempt"; content:"<script>"; nocase; sid:1000004; rev:1;)

# ICMP ping detection
alert icmp any any -> \ any (msg:"ICMP - Ping Detected"; sid:1000005; rev:1;)

# DoS attack detection
alert tcp any any -> \ any (msg:"DOS - TCP SYN Flood"; flags:S; flow:stateless; threshold:type both, track by_src, count 100, seconds 5; sid:1000006; rev:1;)

# Malware traffic detection
alert tcp any any -> any any (msg:"MALWARE - Possible C&C Communication"; content:"bot.command"; nocase; sid:1000007; rev:1;)
